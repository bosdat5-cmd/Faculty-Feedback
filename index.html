<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Faculty Feedback Form</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; background:#f5f7fa; margin:0; padding:0; }
    .container { max-width:700px; margin:30px auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.1);}
    h2 { text-align:center; color:#333; }
    .hidden { display:none; }
    .btn { background:#4CAF50; color:white; padding:10px 18px; border:none; border-radius:6px; cursor:pointer; margin:8px 4px; }
    .btn:hover { background:#45a049; }
    select, input[type="file"] { width:100%; padding:8px; margin:8px 0; border:1px solid #ccc; border-radius:6px;}
    .quote { font-style:italic; color:#555; text-align:center; margin-top:20px; }
  </style>
</head>
<body>
  <div class="container">

    <!-- Page 1: Branch + Day -->
    <div id="page1" class="page">
      <h2>Step 1: Select Branch & Day</h2>
      <label>Choose Branch:</label>
      <select id="branchSelect">
        <option value="">-- Select Branch --</option>
        <option value="CSE">CSE</option>
        <option value="ECE">ECE</option>
        <option value="ME">ME</option>
        <option value="CE">CE</option>
      </select>
      <label>Choose Day:</label>
      <select id="daySelect">
        <option value="">-- Select Day --</option>
        <option value="Day 1">Day 1</option>
        <option value="Day 2">Day 2</option>
        <option value="Day 3">Day 3</option>
        <option value="Day 4">Day 4</option>
        <option value="Day 5">Day 5</option>
        <option value="Day 6">Day 6</option>
        <option value="Day 7">Day 7</option>
        <option value="Day 8">Day 8</option>
        <option value="Day 9">Day 9</option>
        <option value="Day 10">Day 10</option>
        <option value="Day 11">Day 11</option>
        <option value="Day 12">Day 12</option>
        <option value="Day 13">Day 13</option>
        <option value="Day 14">Day 14</option>
        <option value="Day 15">Day 15</option>
      </select>
      <button class="btn" onclick="nextPage()">Next</button>
    </div>

    <!-- Page 2: Upload Excel -->
    <div id="page2" class="page hidden">
      <h2>Step 2: Upload Student Excel</h2>
      <button class="btn" onclick="downloadTemplate()">Download Excel Template</button>
      <input type="file" accept=".xlsx, .xls" onchange="handleFileUpload(event)">
      <label>Select Student (SRN):</label>
      <select id="uniqueKeySelect">
        <option value="">-- Select SRN --</option>
      </select>
      <button class="btn" onclick="prevPage()">Back</button>
      <button class="btn" onclick="nextPage()">Next</button>
    </div>

    <!-- Page 3: Feedback Questions -->
    <div id="page3" class="page hidden">
      <h2>Step 3: Feedback Questions</h2>
      <label>How would you rate the teaching quality?</label>
      <select id="q1">
        <option value="Excellent">Excellent</option>
        <option value="Good">Good</option>
        <option value="Average">Average</option>
        <option value="Poor">Poor</option>
      </select>
      <label>How satisfied are you with course content?</label>
      <select id="q2">
        <option value="Very Satisfied">Very Satisfied</option>
        <option value="Satisfied">Satisfied</option>
        <option value="Neutral">Neutral</option>
        <option value="Unsatisfied">Unsatisfied</option>
      </select>
      <button class="btn" onclick="prevPage()">Back</button>
      <button class="btn" onclick="submitForm()">Submit</button>
    </div>

    <!-- Page 4: Thank You -->
    <div id="page4" class="page hidden">
      <h2>✅ Thank You for Your Feedback!</h2>
      <p class="quote" id="dailyQuote"></p>
    </div>

  </div>

<script>
  let currentPage = 1;

  function nextPage() {
    document.getElementById("page" + currentPage).classList.add("hidden");
    currentPage++;
    document.getElementById("page" + currentPage).classList.remove("hidden");
  }
  function prevPage() {
    document.getElementById("page" + currentPage).classList.add("hidden");
    currentPage--;
    document.getElementById("page" + currentPage).classList.remove("hidden");
  }

  // ✅ Download Excel Template
  function downloadTemplate() {
    const wb = XLSX.utils.book_new();
    const wsData = [["S.No", "SRN", "Name"]]; 
    const ws = XLSX.utils.aoa_to_sheet(wsData);
    XLSX.utils.book_append_sheet(wb, ws, "Template");
    XLSX.writeFile(wb, "Student_Template.xlsx");
  }

  // ✅ Handle Excel Upload
  function handleFileUpload(event) {
    const file = event.target.files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: "array" });
      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

      let srnList = [];
      for (let i = 1; i < jsonData.length; i++) {
        if (jsonData[i][1]) srnList.push(jsonData[i][1]);
      }

      const dropdown = document.getElementById("uniqueKeySelect");
      dropdown.innerHTML = '<option value="">-- Select SRN --</option>';
      srnList.forEach(srn => {
        const opt = document.createElement("option");
        opt.value = srn;
        opt.textContent = srn;
        dropdown.appendChild(opt);
      });
      alert("✅ SRNs loaded successfully!");
    };
    reader.readAsArrayBuffer(file);
  }

  // ✅ Motivational Quotes
  const quotes = [
    "Success is not final, failure is not fatal: it is the courage to continue that counts.",
    "The best way to predict the future is to create it.",
    "Dream big. Start small. Act now.",
    "Believe you can and you're halfway there.",
    "Push yourself, because no one else is going to do it for you.",
    "Great things never come from comfort zones.",
    "Hard work beats talent when talent doesn’t work hard.",
    "Don’t stop until you’re proud.",
    "Doubt kills more dreams than failure ever will."
  ];

  function showDailyQuote() {
    const today = new Date();
    const index = today.getDate() % quotes.length;
    document.getElementById("dailyQuote").innerText = quotes[index];
  }

  // ✅ Submit Form (send to Google Sheets)
  async function submitForm() {
    const payload = {
      branch: document.getElementById("branchSelect").value,
      day: document.getElementById("daySelect").value,
      srn: document.getElementById("uniqueKeySelect").value,
      q1: document.getElementById("q1").value,
      q2: document.getElementById("q2").value
    };

    try {
      const resp = await fetch("YOUR_WEB_APP_URL_HERE", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(payload)
      });
      console.log(await resp.text());
    } catch (err) {
      console.error("Error submitting data:", err);
    }

    // Move to Thank You Page
    document.getElementById("page3").classList.add("hidden");
    document.getElementById("page4").classList.remove("hidden");
    showDailyQuote();
  }
</script>
</body>
</html>
